/*  
    HystModal - Lightweight and flexible JavaScript modal library
    https://github.com/AddMoreScripts/hystModal
    version 0.1
*/
!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.HystModal=e()}(this,function(){"use strict";function t(t){t||(t={}),this.config={backscroll:void 0===t.backscroll||t.backscroll,linkAttributeName:void 0!==t.linkAttributeName&&t.linkAttributeName,closeOnOverlay:void 0===t.closeOnOverlay||t.closeOnOverlay,closeOnEsc:void 0===t.closeOnEsc||t.closeOnEsc,closeOnButton:void 0===t.closeOnButton||t.closeOnButton,waitTransitions:void 0!==t.waitTransitions&&t.waitTransitions,catchFocus:void 0===t.catchFocus||t.catchFocus,beforeOpen:"function"==typeof t.beforeOpen?t.beforeOpen.bind(self):function(){},afterClose:"function"==typeof t.afterClose?t.afterClose.bind(self):function(){}},"string"==typeof t&&(this.config.linkAttributeName=t),this.config.linkAttributeName&&this.init()}return Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(t){let e=this;for(;e;){if(e.matches(t))return e;e=e.parentElement}return null}),t.prototype.init=function(){this._focusElements?console.log("Warning: HystModal cannot be initialized twice"):(this.isOpened=!1,this.openedWindow=!1,this.starter=!1,this._closeAfterTransition=this._closeAfterTransition.bind(this),this._nextWindows=!1,this._scrollPosition=0,this._reopenTrigger=!1,this._overlayChecker=!1,this._isMoved=!1,this._shadow=document.createElement("div"),this._focusElements=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this._shadow.classList.add("hystmodal__shadow"),document.body.appendChild(this._shadow),this.eventsFeeler())},t.prototype.open=function(t){if(t&&(this._nextWindows="string"==typeof t?document.querySelector(t):t),this._nextWindows){if(this.isOpened)return this._reopenTrigger=!0,void this.close();this.openedWindow=this._nextWindows,this.config.beforeOpen(this),this._bodyScrollControl(),this._shadow.classList.add("hystmodal__shadow--show"),this.openedWindow.classList.add("hystmodal--active"),this.openedWindow.style.visibility="visible",this.openedWindow.setAttribute("aria-hidden","false"),this.config.catchFocus&&this.focusContol(),this.isOpened=!0}else console.log("Warinig: hustModal selector is not found")},t.prototype.close=function(){if(this.isOpened){if(this.config.waitTransitions){this.openedWindow.querySelector(".hystmodal__window").addEventListener("transitionend",this._closeAfterTransition),this._isMoved=!0,this.openedWindow.classList.remove("hystmodal--active"),this._shadow.classList.remove("hystmodal__shadow--show")}else this.openedWindow.style.transition="none",this._shadow.style.transition="none",this.openedWindow.classList.remove("hystmodal--active"),this._shadow.classList.remove("hystmodal__shadow--show"),this._closeAfterTransition();this.openedWindow.setAttribute("aria-hidden","true"),this.openedWindow.style.transition="",this._shadow.style.transition=""}},t.prototype._closeAfterTransition=function(t){this.config.catchFocus&&this.focusContol(),this._bodyScrollControl(),this.isOpened=!1,this.openedWindow.scrollTop=0,this.openedWindow.style.visibility="",this._isMoved=!1,this.config.afterClose(this),t&&t.currentTarget.removeEventListener("transitionend",this._closeAfterTransition),this._reopenTrigger&&(this._reopenTrigger=!1,this.open())},t.prototype.eventsFeeler=function(){document.addEventListener("click",function(t){const e=t.target.closest("["+this.config.linkAttributeName+"]");if(!this._isMoved&&e){t.preventDefault(),this.starter=e;const o=this.starter.getAttribute(this.config.linkAttributeName);return this._nextWindows=document.querySelector(o),void this.open()}this.config.closeOnButton&&t.target.closest("[data-hystclose]")&&this.close()}.bind(this)),this.config.closeOnOverlay&&(document.addEventListener("mousedown",function(t){!this._isMoved&&t.target instanceof Element&&!t.target.matches(".hystmodal__wrap")||(this._overlayChecker=!0)}.bind(this)),document.addEventListener("mouseup",function(t){if(!this._isMoved&&t.target instanceof Element&&this._overlayChecker&&t.target.classList.contains("hystmodal__wrap"))return t.preventDefault(),this._overlayChecker,void this.close();this._overlayChecker=!1}.bind(this))),window.addEventListener("keydown",function(t){!this._isMoved&&this.config.closeOnEsc&&27==t.which&&this.isOpened&&(t.preventDefault(),this.close()),!this._isMoved&&this.config.catchFocus&&9==t.which&&this.isOpened&&this.focusCatcher(t)}.bind(this))},t.prototype._bodyScrollControl=function(){if(!this.config.backscroll)return;if(!0===this.isOpened)return document.documentElement.classList.remove("hystmodal__opened"),document.documentElement.style.marginRight="",window.scrollTo(0,this._scrollPosition),void(document.documentElement.style.top="");this._scrollPosition=window.pageYOffset;let t=window.innerWidth-document.documentElement.clientWidth;document.documentElement.style.top=-this._scrollPosition+"px",t&&(document.documentElement.style.marginRight=t+"px"),document.documentElement.classList.add("hystmodal__opened")},t.prototype.focusContol=function(){const t=this.openedWindow.querySelectorAll(this._focusElements);this.isOpened&&this.starter?this.starter.focus():t.length&&t[0].focus()},t.prototype.focusCatcher=function(t){const e=this.openedWindow.querySelectorAll(this._focusElements),o=Array.prototype.slice.call(e);if(this.openedWindow.contains(document.activeElement)){const e=o.indexOf(document.activeElement);t.shiftKey&&0===e&&focusableNodes[o.length-1].focus(),t.shiftKey||e!==o.length-1||(o[0].focus(),t.preventDefault())}else o[0].focus(),t.preventDefault()},{modal:t}});